<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="Secret Word Imposter - A fun party game where players guess who the imposter is">
  <meta name="theme-color" content="#1a1a2e">
  <title>Secret Word Imposter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="index.css">
</head>

<body>
  <div id="app">
    <!-- Animated Background -->
    <div class="bg-gradient"></div>
    <div class="bg-particles"></div>

    <!-- Screen 0: Onboarding / Landing Page -->
    <section id="onboarding-screen" class="screen active">
      <div class="container" style="display: flex; flex-direction: column; justify-content: center; min-height: 80vh;">
        <div class="logo-container" style="margin-bottom: 2rem;">
          <div class="logo-icon blur-glow">üïµÔ∏è</div>
          <h1 class="logo-text header-slide-in">Secret Word</h1>
          <p class="logo-subtitle fade-in" style="animation-delay: 0.3s;">IMPOSTER</p>
        </div>

        <div class="onboarding-actions slide-up"
          style="animation-delay: 0.5s; display: flex; flex-direction: column; gap: 1rem; width: 100%; max-width: 300px; margin: 0 auto;">
          <button id="landing-login-btn" class="btn btn-primary btn-large">
            <span>Log In</span>
          </button>
          <button id="landing-signup-btn" class="btn btn-secondary btn-large">
            <span>Create Account</span>
          </button>
          <div style="text-align: center; color: var(--text-muted); margin: 0.5rem 0; font-size: 0.9rem;">‚Äî or ‚Äî</div>
          <button id="landing-guest-btn" class="btn btn-ghost btn-large" style="background: rgba(255, 255, 255, 0.05);">
            <span>Continue as Guest</span>
          </button>
        </div>
      </div>
    </section>

    <!-- Screen 1: Welcome -->
    <section id="welcome-screen" class="screen">
      <div class="container">

        <!-- Auth Chip -->
        <div class="auth-strip">
          <button id="auth-avatar-btn" class="auth-avatar-btn" title="Account">
            <span id="auth-avatar-emoji">üë§</span>
            <span id="auth-display-name" class="auth-display-name">Guest</span>
          </button>
        </div>

        <div class="logo-container">
          <div class="logo-icon">üïµÔ∏è</div>
          <h1 class="logo-text">Secret Word</h1>
          <p class="logo-subtitle">IMPOSTER</p>
        </div>
        <p class="tagline">Find the imposter among your friends!</p>

        <!-- Mode Selection -->
        <div class="mode-selection">
          <button id="local-mode-btn" class="mode-card">
            <div class="mode-icon">üì±</div>
            <div class="mode-name">Local Mode</div>
            <div class="mode-desc">Pass the phone</div>
          </button>
          <button id="multiplayer-mode-btn" class="mode-card">
            <div class="mode-icon">üåê</div>
            <div class="mode-name">Multiplayer</div>
            <div class="mode-desc">Play online</div>
          </button>
        </div>

        <div class="home-action-row">
          <button id="league-btn" class="btn btn-league">
            <span class="league-btn-icon">üèÜ</span>
            <span>Leagues</span>
          </button>
          <button id="custom-cat-btn" class="btn btn-custom-cat">
            <span class="league-btn-icon">üé®</span>
            <span>My Categories</span>
          </button>
        </div>

        <div class="how-to-play">
          <h3>How to Play</h3>
          <ol>
            <li>Add all players and choose a category</li>
            <li>Each player sees their word privately</li>
            <li>One player is the <strong>imposter</strong> with no word</li>
            <li>Discuss and vote to find the imposter!</li>
          </ol>
        </div>
      </div>
    </section>

    <!-- Screen 2: Player Setup (Local Mode) -->
    <section id="player-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="back-to-welcome">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>Players</h2>
          <div class="player-count-badge" id="player-count">0</div>
        </div>

        <div id="player-list" class="player-list">
          <!-- Players will be dynamically added here -->
        </div>

        <button id="add-player-btn" class="btn btn-secondary btn-add">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14" />
          </svg>
          <span>Add Player</span>
        </button>

        <div class="imposter-settings">
          <label class="setting-label">
            <span>Number of Imposters</span>
            <div class="stepper">
              <button class="stepper-btn" id="imposter-minus">‚àí</button>
              <span id="imposter-count">1</span>
              <button class="stepper-btn" id="imposter-plus">+</button>
              <button class="stepper-btn stepper-randomize" id="imposter-randomize" title="Randomize">üé≤</button>
            </div>
          </label>
        </div>

        <button id="continue-to-category" class="btn btn-primary btn-large" disabled>
          <span>Choose Category</span>
          <svg class="btn-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7" />
          </svg>
        </button>
      </div>
    </section>

    <!-- Screen 3: Category Selection -->
    <section id="category-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="back-to-players">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>Choose Category</h2>
          <div class="spacer"></div>
        </div>

        <div id="category-grid" class="category-grid">
          <!-- Categories will be dynamically added here -->
        </div>
      </div>
    </section>

    <!-- Screen 4: Pass the Phone / Reveal (Local Mode) -->
    <section id="reveal-screen" class="screen">
      <div class="container reveal-container">
        <div class="screen-header">
          <button class="btn-back" id="back-to-category">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>Pass the Phone</h2>
          <div class="progress-indicator">
            <span id="current-player-num">1</span>/<span id="total-players">4</span>
          </div>
        </div>

        <div class="reveal-card" id="reveal-card">
          <div class="reveal-front">
            <div class="player-avatar" id="player-avatar">üë§</div>
            <h3 class="player-name" id="reveal-player-name">Player Name</h3>
            <p class="reveal-instruction">Tap to reveal your word</p>
            <div class="tap-indicator">
              <div class="tap-circle"></div>
              <div class="tap-circle"></div>
              <div class="tap-circle"></div>
            </div>
          </div>
          <div class="reveal-back">
            <div class="word-container">
              <p class="word-label" id="word-label">Your word is:</p>
              <h2 class="secret-word" id="secret-word">SECRET WORD</h2>
            </div>
            <p class="reveal-instruction">Memorize it, then tap to hide</p>
          </div>
        </div>

        <button id="next-player-btn" class="btn btn-primary btn-large">
          <span id="next-player-text">Next Player</span>
          <svg class="btn-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7" />
          </svg>
        </button>
      </div>
    </section>

    <!-- Screen 5: Game in Progress (Local Mode) -->
    <section id="game-screen" class="screen">
      <div class="container">
        <div class="game-header">
          <h2>Game On!</h2>
          <p class="game-subtitle">Find the imposter(s)!</p>
        </div>

        <div class="game-info-card">
          <div class="game-stat">
            <span class="stat-label">Category</span>
            <span class="stat-value" id="game-category">Countries</span>
          </div>
          <div class="game-stat">
            <span class="stat-label">Players</span>
            <span class="stat-value" id="game-player-count">4</span>
          </div>
          <div class="game-stat">
            <span class="stat-label">Imposters</span>
            <span class="stat-value" id="game-imposter-count">1</span>
          </div>
        </div>

        <div class="speaking-order">
          <h3>üé§ First Speaker</h3>
          <p id="first-speaker">Loading...</p>
        </div>

        <div class="game-players-grid" id="game-players-grid">
          <!-- Player cards will be shown here -->
        </div>

        <div class="game-actions">
          <button id="reveal-answer-btn" class="btn btn-danger">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
              <circle cx="12" cy="12" r="3" />
            </svg>
            <span>Reveal Answer</span>
          </button>
          <button id="new-game-btn" class="btn btn-secondary">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M23 4v6h-6M1 20v-6h6" />
              <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15" />
            </svg>
            <span>New Round</span>
          </button>
          <button id="restart-btn" class="btn btn-ghost">
            <span>Change Players</span>
          </button>
        </div>
      </div>
    </section>

    <!-- ==================== MULTIPLAYER SCREENS ==================== -->

    <!-- MP Screen 1: Create or Join -->
    <section id="mp-choice-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="mp-back-to-welcome">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>Multiplayer</h2>
          <div class="spacer"></div>
        </div>

        <div class="mp-choice-container">
          <button id="create-room-btn" class="mp-choice-card">
            <div class="mp-choice-icon">üè†</div>
            <div class="mp-choice-name">Create Room</div>
            <div class="mp-choice-desc">Start a new game and invite friends</div>
          </button>

          <button id="join-room-btn" class="mp-choice-card">
            <div class="mp-choice-icon">üö™</div>
            <div class="mp-choice-name">Join Room</div>
            <div class="mp-choice-desc">Enter a room code to join</div>
          </button>
        </div>
      </div>
    </section>

    <!-- MP Screen 2: Create Room -->
    <section id="mp-create-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="mp-back-to-choice-from-create">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>Create Room</h2>
          <div class="spacer"></div>
        </div>

        <div class="form-container">
          <div class="form-group">
            <label class="form-label">Your Name</label>
            <input type="text" id="host-name-input" class="form-input" placeholder="Enter your name" maxlength="20">
          </div>

          <button id="create-room-submit-btn" class="btn btn-primary btn-large">
            <span>Create Room</span>
            <svg class="btn-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14M12 5l7 7-7 7" />
            </svg>
          </button>
        </div>
      </div>
    </section>

    <!-- MP Screen 3: Join Room -->
    <section id="mp-join-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="mp-back-to-choice-from-join">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>Join Room</h2>
          <div class="spacer"></div>
        </div>

        <div class="form-container">
          <div class="form-group">
            <label class="form-label">Room Code</label>
            <input type="text" id="room-code-input" class="form-input code-input" placeholder="XXXXXX" maxlength="6">
          </div>

          <div class="form-group">
            <label class="form-label">Your Name</label>
            <input type="text" id="join-name-input" class="form-input" placeholder="Enter your name" maxlength="20">
          </div>

          <div id="join-error" class="form-error hidden"></div>

          <button id="join-room-submit-btn" class="btn btn-primary btn-large">
            <span>Join Room</span>
            <svg class="btn-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14M12 5l7 7-7 7" />
            </svg>
          </button>
        </div>
      </div>
    </section>

    <!-- MP Screen 4: Lobby -->
    <section id="mp-lobby-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="mp-leave-lobby">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
              <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
          </button>
          <h2>Lobby</h2>
          <div class="spacer"></div>
        </div>

        <div class="room-code-display">
          <span class="room-code-label">Room Code</span>
          <div class="room-code-value" id="lobby-room-code">XXXXXX</div>
          <button id="copy-code-btn" class="btn btn-ghost btn-small">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            <span>Copy</span>
          </button>
        </div>

        <div class="lobby-category-section">
          <div class="category-display-wrapper">
            <span class="category-label">Category:</span>
            <span class="category-value" id="lobby-category-value">Countries</span>
            <button id="lobby-change-category-btn" class="btn-icon hidden">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
              </svg>
            </button>
          </div>
        </div>


        <!-- Action Area: Host Start/Play or Waiting Msg -->
        <div class="lobby-action-area">
          <div id="host-controls" class="host-controls">
            <button id="mp-start-game-btn" class="btn btn-primary btn-large" disabled>
              <span>Start Game</span>
              <svg class="btn-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M5 12h14M12 5l7 7-7 7" />
              </svg>
            </button>
            <p class="host-hint" id="mp-host-hint">Need at least 3 players to start</p>
          </div>

          <div id="host-postgame-controls" class="host-controls hidden">
            <button id="mp-play-again-btn" class="btn btn-primary btn-large">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M5 12h14M12 5l7 7-7 7" />
              </svg>
              <span>Play</span>
            </button>
          </div>

          <div id="waiting-message" class="waiting-message hidden">
            <button class="btn btn-primary btn-large" disabled>
              <div class="waiting-spinner-small"></div>
              <span>Waiting for host...</span>
            </button>
          </div>

          <div id="player-ready-controls" class="player-ready-controls hidden">
            <button id="mp-lobby-ready-btn" class="btn btn-secondary btn-large">
              <span id="mp-lobby-ready-text">I'm Ready!</span>
            </button>
          </div>
        </div>

        <div class="lobby-players-section">
          <h3 class="section-title">Players (<span id="lobby-player-count">0</span>)</h3>
          <div id="lobby-players-list" class="lobby-players-list">
            <!-- Players will be added here -->
          </div>
        </div>

        <div class="imposter-settings" id="mp-imposter-settings">
          <label class="setting-label">
            <span>Number of Imposters</span>
            <div class="stepper">
              <button class="stepper-btn" id="mp-imposter-minus">‚àí</button>
              <span id="mp-imposter-count">1</span>
              <button class="stepper-btn" id="mp-imposter-plus">+</button>
              <button class="stepper-btn stepper-randomize" id="mp-imposter-randomize" title="Randomize">üé≤</button>
            </div>
          </label>
          <label class="setting-label">
            <span>Anonymous Voting</span>
            <div class="toggle-switch">
              <input type="checkbox" id="mp-anonymous-voting" />
              <span class="toggle-slider"></span>
            </div>
          </label>
        </div>

        <div class="lobby-footer">
          <button id="mp-leave-game-lobby" class="btn btn-text-danger">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
              <polyline points="16 17 21 12 16 7" />
              <line x1="21" y1="12" x2="9" y2="12" />
            </svg>
            <span>Leave Room</span>
          </button>

        </div>
      </div>
    </section>

    <!-- MP Screen 5: Category Selection (Multiplayer) -->
    <section id="mp-category-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="mp-back-to-lobby">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>Choose Category</h2>
          <div class="spacer"></div>
        </div>

        <div id="mp-category-grid" class="category-grid">
          <!-- Categories will be dynamically added here -->
        </div>
      </div>
    </section>

    <!-- MP Screen 6: See Your Word -->
    <section id="mp-word-screen" class="screen">
      <div class="container reveal-container">
        <div class="screen-header">
          <div class="spacer"></div>
          <h2>Your Role</h2>
          <div class="spacer"></div>
        </div>

        <div class="reveal-card" id="mp-reveal-card">
          <div class="reveal-front">
            <div class="player-avatar" id="mp-player-avatar">üë§</div>
            <h3 class="player-name" id="mp-reveal-player-name">Your Name</h3>
            <p class="reveal-instruction">Tap to reveal your word</p>
            <div class="tap-indicator">
              <div class="tap-circle"></div>
              <div class="tap-circle"></div>
              <div class="tap-circle"></div>
            </div>
          </div>
          <div class="reveal-back">
            <div class="word-container">
              <p class="word-label" id="mp-word-label">Your word is:</p>
              <h2 class="secret-word" id="mp-secret-word">SECRET WORD</h2>
            </div>
            <p class="reveal-instruction">Memorize it!</p>
          </div>
        </div>

        <div class="mp-word-status">
          <p id="mp-players-seen">0 of 0 players have seen their word</p>
        </div>

        <button id="mp-ready-btn" class="btn btn-primary btn-large" disabled>
          <span id="mp-ready-btn-text">Ready for Discussion</span>
          <svg class="btn-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7" />
          </svg>
        </button>
      </div>
    </section>

    <!-- MP Screen 7: Discussion -->
    <section id="mp-discussion-screen" class="screen">
      <div class="container">
        <div class="game-header">
          <h2>Discussion Time!</h2>
          <p class="game-subtitle" id="mp-category-display">Category: Countries</p>
        </div>

        <div class="speaking-order" id="mp-speaking-order">
          <h3>üé§ Speaking Order</h3>
          <ol id="mp-speaking-list">
            <!-- Speaking order will be added here -->
          </ol>
        </div>

        <div class="mp-players-grid" id="mp-discussion-players">
          <!-- Player cards -->
        </div>

        <div id="mp-host-voting-controls" class="host-controls hidden">
          <button id="mp-start-voting-btn" class="btn btn-danger btn-large">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
            <span>Start Voting</span>
          </button>
        </div>

        <div id="mp-waiting-voting" class="waiting-message hidden">
          <div class="waiting-spinner"></div>
          <span>Discussing... Host will start voting when ready</span>
        </div>

        <!-- Chat Toggle -->
        <button id="chat-toggle-btn" class="chat-toggle-btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          </svg>
          <span class="chat-badge hidden" id="chat-badge">0</span>
        </button>
      </div>
    </section>

    <!-- MP Screen 8: Voting -->
    <section id="mp-voting-screen" class="screen">
      <div class="container">
        <div class="game-header">
          <h2>üó≥Ô∏è Vote!</h2>
          <p class="game-subtitle">Who is the imposter?</p>
        </div>

        <div class="voting-status">
          <span id="votes-cast">0</span> of <span id="votes-total">0</span> voted
        </div>

        <div class="voting-grid" id="voting-grid">
          <!-- Voting cards -->
        </div>

        <!-- Live votes display -->
        <div class="live-votes" id="live-votes">
          <!-- Who voted for whom will appear here -->
        </div>

        <div class="vote-buttons">
          <button id="submit-vote-btn" class="btn btn-primary btn-large" disabled>
            <span>Submit Vote</span>
          </button>
          <button id="skip-vote-btn" class="btn btn-ghost">
            <span>Skip Vote</span>
          </button>
        </div>

        <div id="vote-waiting" class="waiting-message hidden">
          <div class="waiting-spinner"></div>
          <span>Waiting for all votes...</span>
        </div>
      </div>
    </section>

    <!-- MP Screen 9: Results -->
    <section id="mp-results-screen" class="screen">
      <div class="container relative-container">
        <button id="mp-results-leave-btn" class="btn-top-left">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M15 3h6v18h-6M10 17l5-5-5-5M15 12H3" />
          </svg>
          <span>Leave Room</span>
        </button>

        <div class="results-header" id="results-header">
          <div class="results-icon">üé≠</div>
          <h2 id="results-title">Results</h2>
          <p class="results-subtitle" id="results-subtitle"></p>
        </div>

        <div class="results-card">
          <div class="results-section">
            <p class="results-label">The Secret Word was:</p>
            <h3 class="results-word" id="results-word">WORD</h3>
          </div>

          <div class="results-section">
            <p class="results-label">The Imposter(s):</p>
            <div class="imposters-list" id="results-imposters">
              <!-- Imposter names -->
            </div>
          </div>

          <div class="results-section">
            <p class="results-label">Vote Results:</p>
            <div class="vote-results" id="vote-results">
              <!-- Vote breakdown -->
            </div>
          </div>
        </div>

        <!-- Post-Game Lobby Area -->
        <div class="results-lobby-area">

          <div class="lobby-category-section margin-bottom">
            <div class="category-display-wrapper">
              <span class="category-label">Next Category:</span>
              <span class="category-value" id="results-category-value">Countries</span>
              <button id="results-change-category-btn" class="btn-icon hidden">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
              </button>
            </div>
          </div>

          <div class="lobby-players-section margin-bottom">
            <h3 class="section-title">Players</h3>
            <div id="results-players-list" class="lobby-players-list">
              <!-- Players list with ready status -->
            </div>
          </div>

          <!-- Non-Host Actions -->
          <div id="results-ready-controls" class="ready-controls hidden">
            <button id="mp-results-ready-btn" class="btn btn-secondary btn-large">
              I'm Ready
            </button>
          </div>

          <div id="results-waiting" class="waiting-message hidden">
            <span>Waiting for host...</span>
          </div>

          <!-- Host Actions -->
          <div id="results-host-controls" class="host-controls hidden">
            <!-- Anonymous Voting Toggle -->
            <label class="setting-label margin-bottom">
              <span>Anonymous Voting</span>
              <div class="toggle-switch">
                <input type="checkbox" id="mp-results-anonymous-voting" />
                <span class="toggle-slider"></span>
              </div>
            </label>

            <button id="mp-new-round-btn" class="btn btn-primary btn-large" disabled>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M23 4v6h-6M1 20v-6h6" />
                <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15" />
              </svg>
              <span>New Round</span>
            </button>
            <p class="host-hint" id="results-host-hint">Waiting for players...</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Chat Sidebar -->
    <div id="chat-sidebar" class="chat-sidebar">
      <div class="chat-header">
        <h3>Chat</h3>
        <button id="close-chat-btn" class="btn-close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12" />
          </svg>
        </button>
      </div>
      <div id="chat-messages" class="chat-messages">
        <!-- Messages -->
      </div>
      <div class="chat-input-container">
        <input type="text" id="chat-input" class="chat-input" placeholder="Type a message..." maxlength="100">
        <button id="send-chat-btn" class="btn btn-primary btn-small">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
          </svg>
        </button>
      </div>
    </div>
    <div id="chat-overlay" class="chat-overlay"></div>

    <!-- Answer Reveal Modal (Local Mode) ‚Äî Multi-step -->
    <div id="answer-modal" class="modal">
      <div class="modal-backdrop"></div>
      <div class="modal-content modal-content-league">

        <!-- Step 1: Vote ‚Äî Who is the imposter? -->
        <div id="modal-step-vote" class="modal-step">
          <div class="modal-header">
            <h3>üó≥Ô∏è Who's the Imposter?</h3>
          </div>
          <div class="modal-body">
            <p class="modal-instruction">Tap the player(s) you think are the imposter(s), then confirm.</p>
            <div class="vote-player-grid" id="modal-vote-grid">
              <!-- Player cards for voting -->
            </div>
          </div>
          <div class="modal-footer">
            <button id="modal-confirm-vote-btn" class="btn btn-primary" disabled>Confirm Vote</button>
            <button id="modal-skip-vote-btn" class="btn btn-ghost">Skip (No Vote)</button>
          </div>
        </div>

        <!-- Step 2: Imposter Guess -->
        <div id="modal-step-guess" class="modal-step hidden">
          <div class="modal-header">
            <h3>üïµÔ∏è Imposter's Guess</h3>
          </div>
          <div class="modal-body">
            <p class="modal-instruction">Pass the phone to the imposter ‚Äî can they guess the secret word?</p>
            <div id="imposter-guess-area">
              <!-- Dynamically filled with guess inputs per imposter -->
            </div>
          </div>
          <div class="modal-footer">
            <button id="modal-submit-guess-btn" class="btn btn-primary">Submit Guess</button>
            <button id="modal-skip-guess-btn" class="btn btn-ghost">Skip Guess</button>
          </div>
        </div>

        <!-- Step 3: Results + Points -->
        <div id="modal-step-results" class="modal-step hidden">
          <div class="modal-header">
            <h3 id="modal-results-title">üé≠ Results</h3>
          </div>
          <div class="modal-body">
            <div class="answer-section">
              <p class="answer-label">The Secret Word was:</p>
              <h2 class="answer-word" id="answer-word">WORD</h2>
            </div>
            <div class="answer-section">
              <p class="answer-label">The Imposter(s):</p>
              <div class="imposters-list" id="imposters-list">
                <!-- Imposter names -->
              </div>
            </div>
            <div class="answer-section" id="guess-results-section">
              <!-- Imposter guess results shown here -->
            </div>
            <div class="league-points-summary" id="league-points-summary">
              <h4>üèÜ Points This Round</h4>
              <div id="points-list" class="points-list">
                <!-- Points per player -->
              </div>
            </div>
            <div class="league-selector" id="league-selector">
              <h4>üìã Record to League(s)</h4>
              <div id="league-checkbox-list" class="league-checkbox-list">
                <!-- Checkboxes for each joined league -->
              </div>
              <p class="league-selector-hint" id="league-selector-hint">Join a league from the home screen to track
                points.</p>
            </div>
          </div>
          <div class="modal-footer">
            <button id="save-points-btn" class="btn btn-primary">Save & Done</button>
          </div>
        </div>

      </div>
    </div>

    <!-- League Hub Screen -->
    <section id="league-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="league-back-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>üèÜ Leagues</h2>
          <div class="spacer"></div>
        </div>

        <div class="league-hub-actions">
          <button id="create-league-btn" class="btn btn-primary btn-large">+ Create League</button>
          <button id="join-league-btn" class="btn btn-secondary btn-large">üîó Join League</button>
        </div>

        <div id="league-hub-list" class="league-hub-list">
          <!-- League cards rendered dynamically -->
        </div>
        <div id="league-hub-empty" class="league-empty">
          <p>No leagues yet!</p>
          <p class="league-empty-sub">Create a league or join one with a code.</p>
        </div>
      </div>
    </section>

    <!-- Create / Join League Screen -->
    <section id="league-join-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="league-join-back-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2 id="league-join-title">Create League</h2>
          <div class="spacer"></div>
        </div>

        <!-- Create Mode -->
        <div id="league-create-form" class="league-form">
          <label class="form-label">League Name</label>
          <input type="text" id="league-name-input" class="form-input" placeholder="e.g. Friday Night Crew"
            maxlength="30" autocomplete="off">
          <button id="league-create-submit" class="btn btn-primary btn-large">Create League</button>
        </div>

        <!-- Join Mode -->
        <div id="league-join-form" class="league-form hidden">
          <label class="form-label">League Code</label>
          <input type="text" id="league-code-input" class="form-input league-code-field" placeholder="ABC123"
            maxlength="6" autocomplete="off">
          <button id="league-join-submit" class="btn btn-primary btn-large">Join League</button>
        </div>

        <p id="league-form-error" class="form-error hidden"></p>
      </div>
    </section>

    <!-- League Detail Screen -->
    <section id="league-detail-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="league-detail-back-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2 id="league-detail-name">League</h2>
          <div class="spacer"></div>
        </div>

        <div class="league-code-display">
          <span class="league-code-label">Share this code</span>
          <div class="league-code-box" id="league-code-box">
            <span id="league-detail-code">ABC123</span>
            <button class="btn-copy" id="league-copy-btn" title="Copy code">üìã</button>
          </div>
        </div>

        <div class="league-rules-card">
          <h4>Scoring Rules</h4>
          <ul class="league-rules-list">
            <li><span class="rule-icon">üë•</span> Civilians catch imposter ‚Üí <strong>+1 pt</strong> each</li>
            <li><span class="rule-icon">üïµÔ∏è</span> Imposter survives ‚Üí <strong>+1 pt</strong></li>
            <li><span class="rule-icon">üéØ</span> Imposter guesses word ‚Üí <strong>+1 pt</strong></li>
          </ul>
        </div>

        <div class="league-standings-table" id="league-detail-table">
          <div class="league-empty" id="league-detail-empty">
            <p>No games played yet!</p>
            <p class="league-empty-sub">Play a game and record points to this league.</p>
          </div>
        </div>

        <div class="league-detail-actions">
          <button id="league-leave-btn" class="btn btn-ghost">Leave League</button>
          <button id="league-delete-btn" class="btn btn-ghost btn-danger-text">Delete League</button>
        </div>
      </div>
    </section>

    <!-- ===================== PROFILE SCREEN ===================== -->
    <section id="profile-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="profile-back">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>üë§ Profile</h2>
          <div class="spacer"></div>
        </div>

        <div class="profile-card">
          <div class="profile-avatar-large" id="profile-avatar-large">üë§</div>
          <div id="profile-name-display" class="profile-name-display">Player</div>
          <div id="profile-status-badge" class="profile-status-badge">Guest</div>
        </div>

        <div class="profile-actions">
          <div class="form-group">
            <label class="form-label">Display Name</label>
            <div class="form-row">
              <input type="text" id="profile-name-input" class="form-input" placeholder="Your name" maxlength="20">
              <button id="profile-save-name-btn" class="btn btn-secondary btn-small">Save</button>
            </div>
          </div>

          <div id="profile-upgrade-section">
            <p class="profile-upgrade-hint">Sign in with Google to sync your data across devices.</p>
            <button id="profile-google-btn" class="btn btn-google">
              <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                <path
                  d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
                  fill="#4285F4" />
                <path
                  d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                  fill="#34A853" />
                <path
                  d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"
                  fill="#FBBC05" />
                <path
                  d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84z"
                  fill="#EA4335" />
              </svg>
              <span>Link Google Account</span>
            </button>
          </div>

          <div id="profile-stats" class="profile-stats hidden">
            <div class="profile-stat">
              <span class="profile-stat-value" id="stat-games">‚Äî</span>
              <span class="profile-stat-label">Games</span>
            </div>
            <div class="profile-stat">
              <span class="profile-stat-value" id="stat-wins">‚Äî</span>
              <span class="profile-stat-label">Wins</span>
            </div>
            <div class="profile-stat">
              <span class="profile-stat-value" id="stat-points">‚Äî</span>
              <span class="profile-stat-label">Points</span>
            </div>
          </div>
        </div>

        <button id="profile-signout-btn" class="btn btn-ghost btn-danger-text" style="margin-top:auto">
          Sign Out
        </button>
      </div>
    </section>

    <!-- ===================== CUSTOM CATEGORIES SCREENS ===================== -->

    <!-- My Categories Hub -->
    <section id="custom-cat-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="custom-cat-back">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>üé® My Categories</h2>
          <div class="spacer"></div>
        </div>

        <div class="custom-cat-actions">
          <button id="create-cat-btn" class="btn btn-primary btn-large">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
              <path d="M12 5v14M5 12h14" />
            </svg>
            <span>Create Category</span>
          </button>
          <button id="browse-community-btn" class="btn btn-secondary btn-large">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
              <circle cx="12" cy="12" r="10" />
              <path
                d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
            </svg>
            <span>Community Hub</span>
          </button>
        </div>

        <div id="my-categories-list" class="my-categories-list"></div>
        <div id="my-categories-empty" class="custom-cat-empty hidden">
          <div class="empty-icon">üì≠</div>
          <p>No custom categories yet.</p>
          <p class="empty-hint">Create one or import from the Community Hub!</p>
        </div>
      </div>
    </section>

    <!-- Create / Edit Category -->
    <section id="custom-create-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="create-cat-back">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2 id="create-cat-title">Create Category</h2>
          <div class="spacer"></div>
        </div>

        <div class="form-container">
          <div class="form-group">
            <label class="form-label">Icon</label>
            <div class="emoji-picker" id="emoji-picker">
              <button class="emoji-option selected" data-emoji="üìù">üìù</button>
              <button class="emoji-option" data-emoji="üéØ">üéØ</button>
              <button class="emoji-option" data-emoji="üî•">üî•</button>
              <button class="emoji-option" data-emoji="üåü">üåü</button>
              <button class="emoji-option" data-emoji="üí°">üí°</button>
              <button class="emoji-option" data-emoji="üé≠">üé≠</button>
              <button class="emoji-option" data-emoji="üèÜ">üèÜ</button>
              <button class="emoji-option" data-emoji="üéµ">üéµ</button>
              <button class="emoji-option" data-emoji="üçï">üçï</button>
              <button class="emoji-option" data-emoji="üöÄ">üöÄ</button>
              <button class="emoji-option" data-emoji="üåç">üåç</button>
              <button class="emoji-option" data-emoji="‚ö°">‚ö°</button>
              <button class="emoji-option" data-emoji="üéÆ">üéÆ</button>
              <button class="emoji-option" data-emoji="ü¶Å">ü¶Å</button>
              <button class="emoji-option" data-emoji="üíé">üíé</button>
              <button class="emoji-option" data-emoji="üåà">üåà</button>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Category Name</label>
            <input type="text" id="cat-name-input" class="form-input" placeholder="e.g. Roman Emperors" maxlength="30">
          </div>

          <div class="form-group">
            <label class="form-label">Words <span id="word-count-badge" class="word-count-badge">0</span></label>
            <div class="word-add-row">
              <input type="text" id="word-input" class="form-input" placeholder="Type a word and press Add"
                maxlength="40">
              <button id="add-word-btn" class="btn btn-secondary btn-small">Add</button>
            </div>
            <div id="word-chip-list" class="word-chip-list"></div>
            <p class="form-hint">Add at least 5 words. Aim for 20+.</p>
          </div>

          <div class="form-group publish-section">
            <label class="form-label">Share with Community</label>
            <div class="form-row">
              <input type="text" id="author-name-input" class="form-input" placeholder="Your name (optional)"
                maxlength="20">
              <button id="publish-cat-btn" class="btn btn-secondary btn-small" disabled>Publish üåê</button>
            </div>
            <p id="publish-status" class="publish-status hidden"></p>
          </div>

          <div id="create-cat-error" class="form-error hidden"></div>

          <button id="save-cat-btn" class="btn btn-primary btn-large" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
              <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
              <polyline points="17 21 17 13 7 13 7 21" />
              <polyline points="7 3 7 8 15 8" />
            </svg>
            <span>Save Category</span>
          </button>
        </div>
      </div>
    </section>

    <!-- Community Hub -->
    <section id="community-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn-back" id="community-back">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <h2>üåê Community</h2>
          <div class="spacer"></div>
        </div>

        <div class="community-search-row">
          <input type="text" id="community-search" class="form-input" placeholder="üîç Search categories...">
        </div>

        <div id="community-loading" class="community-loading">
          <div class="waiting-spinner"></div>
          <span>Loading categories...</span>
        </div>

        <div id="community-list" class="community-list hidden"></div>

        <div id="community-empty" class="custom-cat-empty hidden">
          <div class="empty-icon">üåê</div>
          <p>No community categories yet.</p>
          <p class="empty-hint">Be the first to publish one!</p>
        </div>
      </div>
    </section>



    <!-- Profile Screen -->
    <section id="profile-screen" class="screen">
      <div class="container">
        <button id="profile-back" class="back-btn">‚Üê Back</button>
        <h2 class="section-title">My Account</h2>

        <div class="profile-card">
          <div class="profile-avatar-large" id="profile-avatar-large">üë§</div>
          <div class="profile-name-display" id="profile-name-display">Guest</div>
          <div class="profile-status-badge" id="profile-status-badge">üë§ Guest</div>
        </div>

        <div class="profile-actions">
          <!-- Edit name -->
          <div class="form-group">
            <label class="form-label">Display Name</label>
            <div style="display:flex;gap:8px">
              <input type="text" id="profile-name-input" class="form-input" placeholder="Your name" maxlength="24">
              <button id="profile-save-name-btn" class="btn btn-primary" style="white-space:nowrap">Save</button>
            </div>
          </div>

          <!-- Upgrade section (shown for guests) -->
          <div id="profile-upgrade-section">
            <p class="profile-upgrade-hint">Link a Google account to sync your data across devices.</p>
            <button id="profile-google-btn" class="btn-google">üîó Link Google Account</button>
          </div>
        </div>

        <!-- Stats -->
        <div class="profile-stats hidden" id="profile-stats">
          <div class="profile-stat">
            <div class="profile-stat-value" id="stat-games">0</div>
            <div class="profile-stat-label">Games</div>
          </div>
          <div class="profile-stat">
            <div class="profile-stat-value" id="stat-wins">0</div>
            <div class="profile-stat-label">Wins</div>
          </div>
          <div class="profile-stat">
            <div class="profile-stat-value" id="stat-points">0</div>
            <div class="profile-stat-label">Points</div>
          </div>
        </div>

        <button id="profile-signout-btn" class="btn btn-ghost"
          style="width:100%;margin-top:var(--spacing-xl);color:var(--danger)">Sign Out</button>
      </div>
    </section>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
      <div class="loading-spinner"></div>
      <p id="loading-text">Loading...</p>
    </div>
  </div>

  <script src="categories.js"></script>
  <script src="index.js" type="module"></script>
</body>

</html>